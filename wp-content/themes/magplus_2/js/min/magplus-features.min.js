$("#loader").height($(window).height()), carousel = function() {
    function e(e, a, t, i) {
        if (s = i, baseTitle = " Digital Publishing Features - Content Curation Platform, Content Publishing Solutions | mag+", e && "overview" != e && "" != e || (pTitle = baseTitle), splitSlideLink = a.split("product-features/"), n = splitSlideLink[1] ? 1 : 0, e.indexOf(baseTitle) < 0 && e.length) {
            var o = $(".carcl-nav ul .on a").html();
            "Overview" == o && (o = "All Features"), pTitle = baseTitle + " - " + o
        }
        document.title = pTitle, a === d || f || (history.pushState && window.history.pushState({
            section: "Features",
            pTitle: pTitle,
            pUrl: g + a,
            pID: t
        }, "features", a), _gaq.push(["_trackPageview", a])), updateStates(), d = a
		
    }
    var a, t, i, o, n;
    $("#header_wrap").append($(".carcl-nav"));
    var l, r, s, d, c, h, u = $("#header_wrap").height(),
        p = !0,
        f = !1,
        w = 0,
        v = jQuery.browser.webkit ? "body" : "html",
        g = location.protocol + "//" + location.hostname;
    init = function() {
        $(window).ready(function() {
            carousel1 = new $.magcarousel(".carousel", {
                bottomPadding: 100
            }), $(".carcl-slides li a").click(function() {
                return loadPage(), !1
            }), $(".overview a.primary-button").click(function() {
                return $(".carcl-nav li:eq(" + $(this).attr("data-link") + ")").click(), !1
            }), $(window).resize(function() {
                var e = 59;
                if ($("footer.static").length && (e = 0), a = $(window).height() - (u + e), $("#loader").height($(window).height()), $(".holder > div.on").css("min-height", a), $(".mantle").css("height", a), $(".carousel.view").length && $(v).scrollTop() + $(v).scrollTop() > $(".carousel").height() / 2 && (t = $(".holder").offset(), $(window).scrollTop(t.top - u)), !l) {
                    winLoc = location.href;
                    var i;
                    $(".carcl-nav li a").each(function() {
                        $(this).attr("href") == winLoc && (i = !0, $(this).parent().click())
                    }), i || (f = !0, $(".carcl-nav li:eq(0)").click())
                }
            }), $(window).resize()
        }), $(window).scroll(function() {
            h = $(window).scrollTop(), h > a / 2 && !n && r ? e(o, slideLink, i, 0) : a / 2 > h && n && r && e("", "/product-features/", "22179", 0), headerMargin = a - $(window).scrollTop();
            var t = Math.abs(headerMargin) <= u && 0 >= headerMargin;
            t ? ($("#header_wrap.ignore").length || $("#header_wrap").addClass("show").addClass("ignore"), $("#header_wrap").css("margin-top", headerMargin)) : $("#header_wrap.ignore").length && ($("#header_wrap").removeClass("ignore"), $("#header_wrap").css("margin-top", 0), Math.abs(headerMargin) > u && $("#header_wrap").removeClass("show"))
        })
    }, $(".showCarousel .carousel").length ? (p ? autoLoadPages() : init(), amntLoaded(1)) : (loadCarouselWithAjax(), amntLoaded()), $(".carcl-nav li, .btns").click(function() {
        var a = $(this);
        if ($(a).hasClass("next") && (a = $(".carcl-nav ul li:eq(" + ($(".carcl-slides .on").index() + 1) + ")")), $(a).hasClass("back") && (a = $(".carcl-nav ul li:eq(" + ($(".carcl-slides .on").index() - 1) + ")")), a = $(a).find("a"), $(".holder > div").removeClass("on"), $(".holder > div").removeAttr("style"), $("body").removeClass("view"), i = $(a).attr("data-id"), slideLink = $(a).attr("href"), slideLink.indexOf(g) > -1 && (slideLink = slideLink.split(g), slideLink = slideLink[1]), o = $(".carcl-slides li:eq(" + $(a).parent().index() + ")").attr("class")) {
            var t = o.split(" ");
            t[0] && (o = t[0])
        }
        "/product-features/" === window.location.pathname || "/product-features" == window.location.pathname || l ? e("", "/product-features/", "22179", 1) : $(".carcl-slides li:eq(" + $(this).index() + ") a").click()
    }), window.onpopstate = function(e) {
        if (l = !1, e.state && history.pushState) {
            document.title = e.state.pTitle;
            var a;
            $(".carcl-nav li a").each(function() {
                $(this).attr("href") == e.state.pUrl && (f = "subpage", a = !0, $(this).parent().click())
            }), a || (f = "true", $(".carcl-nav li:eq(0)").click())
        }
    }, loadPage = function() {
        function a(a) {
            a = a, $(".holder.content").append('<div class="' + o + '"><div class="shadow-wrapper"></div></div>'), $(".holder.content ." + o + " .shadow-wrapper").append(a), $("#loader").css("display", "none"), $("#loader").removeClass("fadeIn"), e(o, slideLink, i, 1)
        }
        $(".holder.content ." + o).length || "feature" == o ? e(o, slideLink, i, 1) : (showLoader(), $.get("/feature?id=" + i, function(e) {
            a(e)
        }))
    }, updateStates = function() {
        function e(e) {
            s = !1, l || (l = !0, hideLoader()), h || (h = $(window).scrollTop()), f = !1, setTimeout(function() {
                r = !0
            }, 2 * e), w++
        }
        $("body.view").length || $("body").addClass("view"), t = $(".holder").offset(), $(".holder > div").removeClass("on"), $(".holder > div").removeAttr("style"), $(".holder ." + o).addClass("on"), $(".holder > div.on").css("min-height", a + 100), r = !1, c = (t.top - u) * n;
        var i = 500;
        animatedScroll = function() {
            (!l && n || f || !s) && (i = 200), $(v).animate({
                scrollTop: c
            }, i, function() {
                e(i)
            })
        }, s && !f ? animatedScroll() : f ? setTimeout(function() {
            animatedScroll()
        }, 800) : e(i)
    }
};
var loadDisplay;
amntLoaded = function(e) {
    incrm = 1, e && (incrm = 20), count = 1, loadDisplay = setInterval(function() {
        101 > count * incrm && "features" !== pg && ($("#loader em").html("Loading " + count * incrm + "%"), count++)
    }, 30)
}, stopAmntLoaded = function() {
    clearInterval(loadDisplay)
}, hideLoader = function() {
    loadDisplay && stopAmntLoaded(), $("#loader").css("display", "none"), $("#loader").removeClass("fadeIn"), $("#loader em").html("Loading ...")
}, showLoader = function() {
    $("#loader").css("display", "block"), setTimeout(function() {
        $("#loader").addClass("fadeIn")
    }, 100)
}, autoLoadPages = function() {
    function e(e) {
        a++, "features" == pg && hideLoader(), $(".holder.content").html(e), init()
    }
    var a = ($(".carcl-nav ul li").length, 0);
    loadseperate ? $(".carcl-nav ul li").each(function() {
        function e(e) {
            a++, e = e, $(".holder.content").append('<div class="' + i + '"><div class="shadow-wrapper"></div></div>'), $(".holder.content ." + i + " .shadow-wrapper").append(e), $(".holder.content >div").length >= $(".carcl-nav ul li").length && init()
        }
        var t = $(this).find("a").attr("data-id"),
            i = $(".carcl-slides li:eq(" + $(this).index() + ")").attr("class");
        $(".holder.content ." + i).length || $.get("/feature?id=" + t, function(a) {
            e(a)
        })
    }) : $.get("/feature-cache" + uncache, function(a) {
        e(a)
    })
}, loadCarouselWithAjax = function() {
    function e(e) {
        e = e, $(".mantle.showCarousel").append(e), autoLoadPages()
    }
    $.get("/features-carousel", function(a) {
        e(a)
    })
}, outputToLog = function() {}, carousel();